<!DOCTYPE html>
<html class="no-js" language="en-us">

<head>

  
  <title>
        Hashnopolis | Computer Science, Data Science and Awesome Technology
      </title>

    
  




  
  <meta name="author" content="" />
  <meta name="description" content="___SITE Description___" />
  <meta name="keywords" content="___keyword, keyword, keyword___" />

  
  <meta name="twitter:card" content="summary" />
  
  <meta name="twitter:title" content="Hashnopolis" />
  <meta name="twitter:description" content="" />
  <meta name="twitter:image" content="http://www.hashnopolis.com/img/avatar.jpg" />




<meta name="generator" content="Hugo 0.65.3" />


<link rel="canonical" href="http://www.hashnopolis.com/categories/database/" />
<link rel="alternative" href="/index.xml" title="Hashnopolis" type="application/atom+xml" />


<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<meta name="format-detection" content="telephone=no,email=no,adress=no" />
<meta http-equiv="Cache-Control" content="no-transform" />


<meta name="robots" content="index,follow" />
<meta name="referrer" content="origin-when-cross-origin" />







<link rel="apple-touch-icon" sizes="57x57" href="/img/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/img/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/img/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/img/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/img/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/img/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/img/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/img/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/img/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/img/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/img/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/img/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/img/favicon/favicon-16x16.png">
<link rel="manifest" href="/img/favicon/manifest.json">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<meta name="msapplication-TileColor" content="#7679EC">
<meta name="msapplication-TileImage" content="/img/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#7679EC">
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="apple-mobile-web-app-title" content="Hashnopolis" />
<meta name="msapplication-tooltip" content="Hashnopolis" />
<meta name='msapplication-navbutton-color' content="#7679EC" />
<meta name="msapplication-TileColor" content="#7679EC" />
<meta name="msapplication-TileImage" content="/img/favicon/favicon-32x32.png" />



<link rel="stylesheet" href="//cdn.bootcss.com/video.js/6.2.8/alt/video-js-cdn.min.css" />

<link rel="stylesheet" href="/css/highlight.css" />
<link rel="stylesheet" href="/css/highlight-atom-one-dark.min.css" />
<link rel="stylesheet" href="/css/main.css" />
<link rel="stylesheet" href="/css/overrides.css" />




  
  <!--[if lt IE 9]>
    <script src="//cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="//cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <script src="//cdn.bootcss.com/video.js/6.2.8/ie8/videojs-ie8.min.js"></script>
  <![endif]-->

<!--[if lte IE 11]>
    <script src="//cdn.bootcss.com/classlist/1.1.20170427/classList.min.js"></script>
  <![endif]-->


<script src="//cdn.bootcss.com/object-fit-images/3.2.3/ofi.min.js"></script>


<script src="//cdn.bootcss.com/smooth-scroll/12.1.4/js/smooth-scroll.polyfills.min.js"></script>

</head>

<body>
  
  <main class="container left-container">

      <div class="row">

        <section id="sideber" class="sidebar">
          <span id="mobile-menu-open" style="position: absolute; top: 1.1rem; left: 1rem; color: #fff;"><i class="material-icons">menu</i></span>
<a href="/" class="menu-logo">
  <h1  class="menu-logo__text"># Hashnopolis #</h1>
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" enable-background="new 0 0 16 16" x="0px" y="0px">
    <g>
      <path d="M10.001 16l-.143-.01c-.547-.078-.926-.585-.849-1.132l2-14c.078-.546.588-.926 1.132-.848.547.078.927.584.849 1.131l-2 14c-.071.5-.499.859-.989.859zM4.001 16l-.143-.01c-.546-.078-.926-.585-.848-1.132l2-14c.078-.547.58-.927 1.132-.848.546.078.926.585.848 1.132l-2 14c-.072.499-.499.858-.989.858zM15 6h-13c-.552 0-1-.448-1-1s.448-1 1-1h13c.553 0 1 .448 1 1s-.447 1-1 1zM14 12h-13c-.552 0-1-.447-1-1s.448-1 1-1h13c.553 0 1 .447 1 1s-.447 1-1 1z"/>
    </g>
  </svg>
</a>




<ul id="mobile-menu" class="navigation">
  <li id="mobile-menu-close" style="margin-top: 1.5rem; color: #7679EC"><i class="material-icons">close</i></li>
  <li><a href="/">Home</a></li>
  
  
  <li><a href="/categories/java">Java</a></li>
  <li><a href="/categories/python">Python</a></li>
  <li><a href="/categories/javascript">JavaScript</a></li>
  <li><a href="/categories/algorithm">Algorithm</a></li>
  <li><a href="/categories">Categories</a></li>
  <li><a href="/tags">tags</a></li>
  <li><a href="/about">About</a></li>
  
</ul>
<div class="site-info">
  <div class="primary-info">
    <h1>Computer Science, Data Science and Awesome Technology</h1>
    <footer class="site-footer">
    <p>© 2016-2020 <a href="http://www.hashnopolis.com">Hashnopolis</a></p>
    
    </footer>
  </div>

  
  <div class="social-info">
      <a href="https://linkedin.com/in/lektin/"><i class="fa fa-linkedin-square" aria-hidden="true"></i></a>
      <a href="https://github.com/lek-tin"><i class="fa fa-github" aria-hidden="true"></i></a>
  </div>
</div>


        </section>
    
        <section class="main-content">
          

  
  
  <h2 class="taxonomy-single--title">database:</h2>
  <div>
    
    
      
        
<article class="post">
  <div class="post-preview col-xs-12  no-gutter">
      <h2><a href="http://www.hashnopolis.com/post/active-businesses/">Active Businesses</a></h2>

      <p>Table: Events
&#43;---------------&#43;---------&#43; | Column Name | Type | &#43;---------------&#43;---------&#43; | business_id | int | | event_type | varchar | | occurences | int | &#43;---------------&#43;---------&#43; (business_id, event_type) is the primary key of this table. Each row in the table logs the info that an event of some type occured at some business for a number of times. Write an SQL query to find all active businesses.
An active business is a business that has more than one event type with occurences greater than the average occurences of that event type among all businesses.</p>

      <p class="meta">
        
        by
        
          <a class="meta--author" href="/authors/lek-tin" ><strong>lek tin</strong></a>
        
        in
        
          <a  class="meta--cat" href="/categories/database" ><strong>"database"</strong></a>
        
        <i class="link-spacer"></i><i class="small material-icons">access_time</i> 2-min read
      </p>
  </div>

  

</article>
      
        
<article class="post">
  <div class="post-preview col-xs-12  no-gutter">
      <h2><a href="http://www.hashnopolis.com/post/second-degree-follower/">Second Degree Follower</a></h2>

      <p>In facebook, there is a follow table with two columns: followee, follower.
Please write a sql query to get the amount of each follower’s follower if he/she has one.
For example:
&#43;-------------&#43;------------&#43; | followee | follower | &#43;-------------&#43;------------&#43; | A | B | | B | C | | B | D | | D | E | &#43;-------------&#43;------------&#43; should output: &#43;-------------&#43;------------&#43; | follower | num | &#43;-------------&#43;------------&#43; | B | 2 | | D | 1 | &#43;-------------&#43;------------&#43; Explaination: Both B and D exist in the follower list, when as a followee, B&#39;s follower is C and D, and D&#39;s follower is E.</p>

      <p class="meta">
        
        by
        
          <a class="meta--author" href="/authors/lek-tin" ><strong>lek tin</strong></a>
        
        in
        
          <a  class="meta--cat" href="/categories/database" ><strong>"database"</strong></a>
        
        <i class="link-spacer"></i><i class="small material-icons">access_time</i> 1-min read
      </p>
  </div>

  

</article>
      
        
<article class="post">
  <div class="post-preview col-xs-12  no-gutter">
      <h2><a href="http://www.hashnopolis.com/post/last-person-to-fit-in-the-elevator/">Last Person to Fit in the Elevator</a></h2>

      <p>Table: Queue
&#43;-------------&#43;---------&#43; | Column Name | Type | &#43;-------------&#43;---------&#43; | person_id | int | | person_name | varchar | | weight | int | | turn | int | &#43;-------------&#43;---------&#43; person_id is the primary key column for this table. This table has the information about all people waiting for an elevator. The person_id and turn columns will contain all numbers from 1 to n, where n is the number of rows in the table.</p>

      <p class="meta">
        
        by
        
          <a class="meta--author" href="/authors/lek-tin" ><strong>lek tin</strong></a>
        
        in
        
          <a  class="meta--cat" href="/categories/database" ><strong>"database"</strong></a>
        
        <i class="link-spacer"></i><i class="small material-icons">access_time</i> 2-min read
      </p>
  </div>

  

</article>
      
        
<article class="post">
  <div class="post-preview col-xs-12  no-gutter">
      <h2><a href="http://www.hashnopolis.com/post/movie-rating/">Movie Rating</a></h2>

      <p>Table: Movies
&#43;---------------&#43;---------&#43; | Column Name | Type | &#43;---------------&#43;---------&#43; | movie_id | int | | title | varchar | &#43;---------------&#43;---------&#43; movie_id is the primary key for this table. title is the name of the movie. Table: Users
&#43;---------------&#43;---------&#43; | Column Name | Type | &#43;---------------&#43;---------&#43; | user_id | int | | name | varchar | &#43;---------------&#43;---------&#43; user_id is the primary key for this table. Table: Movie_Rating
&#43;---------------&#43;---------&#43; | Column Name | Type | &#43;---------------&#43;---------&#43; | movie_id | int | | user_id | int | | rating | int | | created_at | date | &#43;---------------&#43;---------&#43; (movie_id, user_id) is the primary key for this table.</p>

      <p class="meta">
        
        by
        
          <a class="meta--author" href="/authors/lek-tin" ><strong>lek tin</strong></a>
        
        in
        
          <a  class="meta--cat" href="/categories/database" ><strong>"database"</strong></a>
        
        <i class="link-spacer"></i><i class="small material-icons">access_time</i> 3-min read
      </p>
  </div>

  

</article>
      
        
<article class="post">
  <div class="post-preview col-xs-12  no-gutter">
      <h2><a href="http://www.hashnopolis.com/post/team-scores-in-football-tournament/">Team Scores in Football Tournament</a></h2>

      <p>Solution (Union) SELECT t.team_id, t.team_name, IFNULL(SUM(p.points), 0) AS num_points FROM Teams t LEFT JOIN ( SELECT host_team as team_id, CASE WHEN host_goals &gt; guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END as points FROM Matches UNION ALL SELECT guest_team as team_id, CASE WHEN host_goals &lt; guest_goals THEN 3 WHEN host_goals = guest_goals THEN 1 ELSE 0 END as points FROM Matches ) AS p ON t.team_id = p.</p>

      <p class="meta">
        
        by
        
          <a class="meta--author" href="/authors/lek-tin" ><strong>lek tin</strong></a>
        
        in
        
          <a  class="meta--cat" href="/categories/database" ><strong>"database"</strong></a>
        
        <i class="link-spacer"></i><i class="small material-icons">access_time</i> 1-min read
      </p>
  </div>

  

</article>
      
        
<article class="post">
  <div class="post-preview col-xs-12  no-gutter">
      <h2><a href="http://www.hashnopolis.com/post/highest-grade-for-each-student/">Highest Grade for Each Student</a></h2>

      <p>Table: Enrollments
&#43;---------------&#43;---------&#43; | Column Name | Type | &#43;---------------&#43;---------&#43; | student_id | int | | course_id | int | | grade | int | &#43;---------------&#43;---------&#43; (student_id, course_id) is the primary key of this table. Write a SQL query to find the highest grade with its corresponding course for each student. In case of a tie, you should find the course with the smallest course_id. The output must be sorted by increasing student_id.</p>

      <p class="meta">
        
        by
        
          <a class="meta--author" href="/authors/lek-tin" ><strong>lek tin</strong></a>
        
        in
        
          <a  class="meta--cat" href="/categories/database" ><strong>"database"</strong></a>
        
        <i class="link-spacer"></i><i class="small material-icons">access_time</i> 1-min read
      </p>
  </div>

  

</article>
      
        
<article class="post">
  <div class="post-preview col-xs-12  no-gutter">
      <h2><a href="http://www.hashnopolis.com/post/department-highest-salary/">Department Highest Salary</a></h2>

      <p>The Employee table holds all employees. Every employee has an Id, a salary, and there is also a column for the department Id.
&#43;----&#43;-------&#43;--------&#43;--------------&#43; | Id | Name | Salary | DepartmentId | &#43;----&#43;-------&#43;--------&#43;--------------&#43; | 1 | Joe | 70000 | 1 | | 2 | Jim | 90000 | 1 | | 3 | Henry | 80000 | 2 | | 4 | Sam | 60000 | 2 | | 5 | Max | 90000 | 1 | &#43;----&#43;-------&#43;--------&#43;--------------&#43; The Department table holds all departments of the company.</p>

      <p class="meta">
        
        by
        
          <a class="meta--author" href="/authors/lek-tin" ><strong>lek tin</strong></a>
        
        in
        
          <a  class="meta--cat" href="/categories/database" ><strong>"database"</strong></a>
        
        <i class="link-spacer"></i><i class="small material-icons">access_time</i> 2-min read
      </p>
  </div>

  

</article>
      
        
<article class="post">
  <div class="post-preview col-xs-12  no-gutter">
      <h2><a href="http://www.hashnopolis.com/post/rank-scores/">Rank Scores</a></h2>

      <p>Write a SQL query to rank scores. If there is a tie between two scores, both should have the same ranking. Note that after a tie, the next ranking number should be the next consecutive integer value. In other words, there should be no “holes” between ranks.
&#43;----&#43;-------&#43; | Id | Score | &#43;----&#43;-------&#43; | 1 | 3.50 | | 2 | 3.65 | | 3 | 4.00 | | 4 | 3.</p>

      <p class="meta">
        
        by
        
          <a class="meta--author" href="/authors/lek-tin" ><strong>lek tin</strong></a>
        
        in
        
          <a  class="meta--cat" href="/categories/database" ><strong>"database"</strong></a>
        
        <i class="link-spacer"></i><i class="small material-icons">access_time</i> 2-min read
      </p>
  </div>

  

</article>
      
        
<article class="post">
  <div class="post-preview col-xs-12  no-gutter">
      <h2><a href="http://www.hashnopolis.com/post/second-highest-salary/">Second Highest Salary</a></h2>

      <p>Write a SQL query to get the second highest salary from the Employee table.
&#43;----&#43;--------&#43; | Id | Salary | &#43;----&#43;--------&#43; | 1 | 100 | | 2 | 200 | | 3 | 300 | &#43;----&#43;--------&#43; For example, given the above Employee table, the query should return 200 as the second highest salary. If there is no second highest salary, then the query should return null.
&#43;---------------------&#43; | SecondHighestSalary | &#43;---------------------&#43; | 200 | &#43;---------------------&#43; Solution (naive) SELECT max(Salary) as SecondHighestSalary FROM Employee WHERE Salary NOT IN (SELECT max(Salary) FROM Employee) Solution This solution considers when second highest salary doesn’t exist</p>

      <p class="meta">
        
        by
        
          <a class="meta--author" href="/authors/lek-tin" ><strong>lek tin</strong></a>
        
        in
        
          <a  class="meta--cat" href="/categories/database" ><strong>"database"</strong></a>
        
        <i class="link-spacer"></i><i class="small material-icons">access_time</i> 1-min read
      </p>
  </div>

  

</article>
      
        
<article class="post">
  <div class="post-preview col-xs-12  no-gutter">
      <h2><a href="http://www.hashnopolis.com/post/top-useful-sql-templates/">Top Useful Sql Templates</a></h2>

      <p>In this post, we introduce the most useful SQL template statements.
Find all duplicates based on a field SELECT [EmailAddress], [CustomerName] FROM [Customers] WHERE [EmailAddress] IN (SELECT [EmailAddress] FROM [Customers] GROUP BY [EmailAddress] HAVING COUNT(*) &gt; 1) This is significantly more efficient than using EXISTS
Select DISTINCT on multiple columns We can select distinct on multiple columns(distinct combinations of column values.), for example, gender(male) AND age(&gt;18).
Select duplicate rows based on column SELECT TOP 1 C1.</p>

      <p class="meta">
        
        by
        
          <a class="meta--author" href="/authors/lek-tin" ><strong>lek tin</strong></a>
        
        in
        
          <a  class="meta--cat" href="/categories/database" ><strong>"database"</strong></a>
        
        <i class="link-spacer"></i><i class="small material-icons">access_time</i> 1-min read
      </p>
  </div>

  

</article>
      
    
    
      <footer class="list-footer">
        <nav class="pagination">
        
        
          <a class="pagination-previous" href="/categories/database/">← Newer Posts</a>
        
        
          <a class="pagination-next" href="/categories/database/page/3/">Older Posts →</a>
        
        </nav>
      </footer>
    
  </div>
  

        </section>
        

      </div>
      

  </main>

  


<script src="/js/bundle.js"></script>


<script src="/js/vendor/modernizr.custom.32229-2.8-respondjs-1-4-2.js"></script>
<script src="/js/vendor/jquery-1.11.2.min.js"></script>
<script src="/js/vendor/jquery.jpanelmenu.min.js"></script>
<script src="/js/vendor/highlight.min.js"></script>
<script src="/js/vendor/fastclick.min.js"></script>
<script src="/js/main.js"></script>


<script id="dsq-count-scr" src="//hashnopolis.disqus.com/count.js" async></script>

</body>

</html>