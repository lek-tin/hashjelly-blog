<!DOCTYPE html>
<html class="no-js" language="en-us">

<head>

  
  <title>
        Repair Broken Edges of a Graph | Hashnopolis
      </title>

    
  




  
  <meta name="author" content="" />
  <meta name="description" content="There&amp;rsquo;s an undirected connected graph with n nodes labeled 1..n. But some of the edges has been broken disconnecting the graph. Find the minimum cost to repair the edges so that all the nodes are once again accessible from each other.
Input  n, an int representing the total number of nodes. edges, a list of integer pair representing the nodes connected by an edge. edgesToRepair, a list where each element is a triplet representing the pair of nodes between which an edge is currently broken and the cost of repearing that edge respectively (e." />
  <meta name="keywords" content="leetcode minimum-spanning-tree " />
  
  
    <meta name="twitter:card" content="summary" />
    
    <meta name="twitter:title" content="Repair Broken Edges of a Graph" />
    <meta name="twitter:description" content="There&amp;rsquo;s an undirected connected graph with n nodes labeled 1..n. But some of the edges has been broken disconnecting the graph. Find the minimum cost to repair the edges so that all the nodes are once again accessible from each other.
Input  n, an int representing the total number of nodes. edges, a list of integer pair representing the nodes connected by an edge. edgesToRepair, a list where each element is a triplet representing the pair of nodes between which an edge is currently broken and the cost of repearing that edge respectively (e." />
    <meta name="twitter:image" content="http://www.hashnopolis.com/img/avatar.jpg" />
  




<meta name="generator" content="Hugo 0.69.2" />


<link rel="canonical" href="http://www.hashnopolis.com/post/repair-broken-edges-of-a-graph/" />
<link rel="alternative" href="/index.xml" title="Hashnopolis" type="application/atom+xml" />


<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<meta name="format-detection" content="telephone=no,email=no,adress=no" />
<meta http-equiv="Cache-Control" content="no-transform" />


<meta name="robots" content="index,follow" />
<meta name="referrer" content="origin-when-cross-origin" />







<link rel="apple-touch-icon" sizes="57x57" href="/img/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/img/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/img/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/img/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/img/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/img/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/img/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/img/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/img/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/img/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/img/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/img/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/img/favicon/favicon-16x16.png">
<link rel="manifest" href="/img/favicon/manifest.json">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<meta name="msapplication-TileColor" content="#7679EC">
<meta name="msapplication-TileImage" content="/img/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#7679EC">
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="apple-mobile-web-app-title" content="Hashnopolis" />
<meta name="msapplication-tooltip" content="Hashnopolis" />
<meta name='msapplication-navbutton-color' content="#7679EC" />
<meta name="msapplication-TileColor" content="#7679EC" />
<meta name="msapplication-TileImage" content="/img/favicon/favicon-32x32.png" />



<link rel="stylesheet" href="//cdn.bootcss.com/video.js/6.2.8/alt/video-js-cdn.min.css" />

<link rel="stylesheet" href="/css/highlight.css" />
<link rel="stylesheet" href="/css/highlight-atom-one-dark.min.css" />
<link rel="stylesheet" href="/css/main.css" />
<link rel="stylesheet" href="/css/overrides.css" />




  
  <!--[if lt IE 9]>
    <script src="//cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="//cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <script src="//cdn.bootcss.com/video.js/6.2.8/ie8/videojs-ie8.min.js"></script>
  <![endif]-->

<!--[if lte IE 11]>
    <script src="//cdn.bootcss.com/classlist/1.1.20170427/classList.min.js"></script>
  <![endif]-->


<script src="//cdn.bootcss.com/object-fit-images/3.2.3/ofi.min.js"></script>


<script src="//cdn.bootcss.com/smooth-scroll/12.1.4/js/smooth-scroll.polyfills.min.js"></script>

</head>

<body>
  
  <main class="container left-container">

      <div class="row">

        <section id="sideber" class="sidebar">
          <span id="mobile-menu-open" style="position: absolute; top: 1.1rem; left: 1rem; color: #fff;"><i class="material-icons">menu</i></span>
<a href="/" class="menu-logo">
  <h1  class="menu-logo__text"># Hashnopolis #</h1>
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" enable-background="new 0 0 16 16" x="0px" y="0px">
    <g>
      <path d="M10.001 16l-.143-.01c-.547-.078-.926-.585-.849-1.132l2-14c.078-.546.588-.926 1.132-.848.547.078.927.584.849 1.131l-2 14c-.071.5-.499.859-.989.859zM4.001 16l-.143-.01c-.546-.078-.926-.585-.848-1.132l2-14c.078-.547.58-.927 1.132-.848.546.078.926.585.848 1.132l-2 14c-.072.499-.499.858-.989.858zM15 6h-13c-.552 0-1-.448-1-1s.448-1 1-1h13c.553 0 1 .448 1 1s-.447 1-1 1zM14 12h-13c-.552 0-1-.447-1-1s.448-1 1-1h13c.553 0 1 .447 1 1s-.447 1-1 1z"/>
    </g>
  </svg>
</a>




<ul id="mobile-menu" class="navigation">
  <li id="mobile-menu-close" style="margin-top: 1.5rem; color: #7679EC"><i class="material-icons">close</i></li>
  <li><a href="/">Home</a></li>
  
  
  <li><a href="/categories/java">Java</a></li>
  <li><a href="/categories/python">Python</a></li>
  <li><a href="/categories/javascript">JavaScript</a></li>
  <li><a href="/categories/algorithm">Algorithm</a></li>
  <li><a href="/categories">Categories</a></li>
  <li><a href="/tags">tags</a></li>
  <li><a href="/about">About</a></li>
  
</ul>
<div class="site-info">
  <div class="primary-info">
    <h1>Computer Science, Data Science and Awesome Technology</h1>
    <footer class="site-footer">
    <p>Â© 2016-2020 <a href="http://www.hashnopolis.com">Hashnopolis</a></p>
    
    </footer>
  </div>

  
  <div class="social-info">
      <a href="https://linkedin.com/in/lektin/"><i class="fa fa-linkedin-square" aria-hidden="true"></i></a>
      <a href="https://github.com/lek-tin"><i class="fa fa-github" aria-hidden="true"></i></a>
  </div>
</div>


        </section>
    
        <section class="main-content">
          
  

  
  <div class="post">
      <p class="meta">
        
        
        <span class="highlight">Tags:</span>
        
          "<a href="/tags/leetcode"><strong>leetcode</strong></a>",
        
          "<a href="/tags/minimum-spanning-tree"><strong>minimum-spanning-tree</strong></a>",
        
        <i class="small material-icons">access_time</i> 4-min read
      </p>
      <a class="github-corner" href="https://github.com/lek-tin/hashnopolis/blob/dev/content/post/repair-broken-edges-of-a-graph.md" title="Edit this post on Github"><svg width="50" height="50" viewbox="0 0 250 250"><title>Edit this post on Github</title><path d="M0 0h250v250"></path><path class="octo-arm" d="M127.4 110c-14.6-9.2-9.4-19.5-9.4-19.5 3-7 1.5-11 1.5-11-1-6.2 3-2 3-2 4 4.7 2 11 2 11-2.2 10.4 5 14.8 9 16.2" fill="currentColor" style="transform-origin:130px 110px;"></path><path class="octo-body" d="M113.2 114.3s3.6 1.6 4.7.6l15-13.7c3-2.4 6-3 8.2-2.7-8-11.2-14-25 3-41 4.7-4.4 10.6-6.4 16.2-6.4.6-1.6 3.6-7.3 11.8-10.7 0 0 4.5 2.7 6.8 16.5 4.3 2.7 8.3 6 12 9.8 3.3 3.5 6.7 8 8.6 12.3 14 3 16.8 8 16.8 8-3.4 8-9.4 11-11.4 11 0 5.8-2.3 11-7.5 15.5-16.4 16-30 9-40 .2 0 3-1 7-5.2 11l-13.3 11c-1 1 .5 5.3.8 5z" fill="currentColor"></path></svg><style> .github-corner svg{position:absolute;right:0;top:0;mix-blend-mode:darken;color:#ffffff;fill:#7479ec;} @media (max-width: 767px) { .github-corner svg { top: 48px; } } .github-corner:hover .octo-arm{animation:octocat-wave .56s;}@keyframes octocat-wave{0%, 100%{transform:rotate(0);}20%, 60%{transform:rotate(-20deg);}40%, 80%{transform:rotate(10deg);}}</style></a>
      <h1>Repair Broken Edges of a Graph</h1>
      <h4>Created: February 29, 2020 by [lek-tin]</h4>
      
        <h5>Last updated: February 29, 2020</h5>
      
      <hr />
      <p>There&rsquo;s an undirected connected graph with n nodes labeled <code>1..n</code>. But some of the edges has been broken disconnecting the graph. Find the minimum cost to repair the edges so that all the nodes are once again accessible from each other.</p>
<h4 id="input">Input</h4>
<ul>
<li>n, an int representing the total number of nodes.</li>
<li>edges, a list of integer pair representing the nodes connected by an edge.</li>
<li>edgesToRepair, a list where each element is a triplet representing the pair of nodes between which an edge is currently broken and the cost of repearing that edge respectively (e.g. [1, 2, 12] means to repear an edge between nodes 1 and 2, the cost would be 12).</li>
</ul>
<h3 id="example-1">Example 1</h3>
<pre><code>Input: n = 5, edges = [[1, 2], [2, 3], [3, 4], [4, 5], [1, 5]], edgesToRepair = [[1, 2, 12], [3, 4, 30], [1, 5, 8]]
Output: 20
Explanation:
There are 3 connected components due to broken edges: [1], [2, 3] and [4, 5].
We can connect these components into a single component by repearing the edges between nodes 1 and 2, and nodes 1 and 5 at a minimum cost 12 + 8 = 20.
</code></pre><h3 id="example-2">Example 2</h3>
<pre><code>Input: n = 6, edges = [[1, 2], [2, 3], [4, 5], [3, 5], [1, 6], [2, 4]], edgesToRepair = [[1, 6, 410], [2, 4, 800]]
Output: 410
</code></pre><h3 id="example-3">Example 3</h3>
<pre><code>Input: n = 6, edges = [[1, 2], [2, 3], [4, 5], [5, 6], [1, 5], [2, 4], [3, 4]], edgesToRepair = [[1, 5, 110], [2, 4, 84], [3, 4, 79]]
Output: 79
</code></pre><h3 id="solution-prims">Solution (Prim&rsquo;s)</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> defaultdict
<span style="color:#f92672">import</span> heapq

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Solution</span>:
    <span style="color:#66d9ef">def</span> __init__(self):
        <span style="color:#66d9ef">pass</span>

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">minCostForRepair</span>(self, n, edges, edgesToRepair):
        graph<span style="color:#f92672">=</span>defaultdict(list)
        addedEdges<span style="color:#f92672">=</span>set()
        <span style="color:#66d9ef">for</span> edge <span style="color:#f92672">in</span> edgesToRepair:
            graph[edge[<span style="color:#ae81ff">0</span>]]<span style="color:#f92672">.</span>append((edge[<span style="color:#ae81ff">2</span>], edge[<span style="color:#ae81ff">1</span>]))
            graph[edge[<span style="color:#ae81ff">1</span>]]<span style="color:#f92672">.</span>append((edge[<span style="color:#ae81ff">2</span>], edge[<span style="color:#ae81ff">0</span>]))
            addedEdges<span style="color:#f92672">.</span>add((edge[<span style="color:#ae81ff">0</span>], edge[<span style="color:#ae81ff">1</span>]))
            addedEdges<span style="color:#f92672">.</span>add((edge[<span style="color:#ae81ff">1</span>], edge[<span style="color:#ae81ff">0</span>]))
        <span style="color:#66d9ef">for</span> edge <span style="color:#f92672">in</span> edges:
            <span style="color:#66d9ef">if</span> tuple(edge) <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> addedEdges:
                graph[edge[<span style="color:#ae81ff">0</span>]]<span style="color:#f92672">.</span>append((<span style="color:#ae81ff">0</span>, edge[<span style="color:#ae81ff">1</span>]))
                graph[edge[<span style="color:#ae81ff">1</span>]]<span style="color:#f92672">.</span>append((<span style="color:#ae81ff">0</span>, edge[<span style="color:#ae81ff">0</span>]))

        res<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
        priorityQueue<span style="color:#f92672">=</span>[(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>)]
        heapq<span style="color:#f92672">.</span>heapify(priorityQueue)
        visited<span style="color:#f92672">=</span>set()

        <span style="color:#66d9ef">while</span> priorityQueue:
            minCost, node<span style="color:#f92672">=</span>heapq<span style="color:#f92672">.</span>heappop(priorityQueue)
            <span style="color:#66d9ef">if</span> node <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> visited:
                visited<span style="color:#f92672">.</span>add(node)
                res<span style="color:#f92672">+=</span>minCost
                <span style="color:#66d9ef">for</span> cost, connectedNode <span style="color:#f92672">in</span> graph[node]:
                    <span style="color:#66d9ef">if</span> connectedNode <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> visited:
                        heapq<span style="color:#f92672">.</span>heappush(priorityQueue, (cost, connectedNode))

        <span style="color:#66d9ef">return</span> res


s<span style="color:#f92672">=</span>Solution()

<span style="color:#66d9ef">print</span>(s<span style="color:#f92672">.</span>minCostForRepair(<span style="color:#ae81ff">5</span>, [[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>], [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>], [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>], [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>], [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>]], [[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">12</span>], [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">30</span>], [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">8</span>]]))
<span style="color:#66d9ef">print</span>(s<span style="color:#f92672">.</span>minCostForRepair(<span style="color:#ae81ff">6</span>, [[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>], [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>], [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>], [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">5</span>], [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">6</span>], [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>]], [[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">410</span>], [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">800</span>]]))
<span style="color:#66d9ef">print</span>(s<span style="color:#f92672">.</span>minCostForRepair(<span style="color:#ae81ff">6</span>, [[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>], [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>], [<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>], [<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>], [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>], [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>], [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>]], [[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">110</span>], [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">84</span>], [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">79</span>]]))
</code></pre></div><h3 id="solution-kruskals--union-find">Solution (Kruskal&rsquo;s + Union-Find)</h3>
<p>We first find a minimum spannig tree using Kruskal&rsquo;s algorithm that contain ok edges and broken edges. We set existing edges to have 0 cost, while the broken edges have their repair cost.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Main</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">int</span> n <span style="color:#f92672">=</span> 6<span style="color:#f92672">;</span>
        <span style="color:#66d9ef">int</span><span style="color:#f92672">[][]</span> edges <span style="color:#f92672">=</span> <span style="color:#f92672">{{</span>1<span style="color:#f92672">,</span> 4<span style="color:#f92672">},</span> <span style="color:#f92672">{</span>4<span style="color:#f92672">,</span> 5<span style="color:#f92672">},</span> <span style="color:#f92672">{</span>2<span style="color:#f92672">,</span> 3<span style="color:#f92672">}};</span>
        <span style="color:#66d9ef">int</span><span style="color:#f92672">[][]</span> newEdges <span style="color:#f92672">=</span> <span style="color:#f92672">{{</span>1<span style="color:#f92672">,</span> 2<span style="color:#f92672">,</span> 5<span style="color:#f92672">},</span> <span style="color:#f92672">{</span>1<span style="color:#f92672">,</span> 3<span style="color:#f92672">,</span> 10<span style="color:#f92672">},</span> <span style="color:#f92672">{</span>1<span style="color:#f92672">,</span> 6<span style="color:#f92672">,</span> 2<span style="color:#f92672">},</span> <span style="color:#f92672">{</span>5<span style="color:#f92672">,</span> 6<span style="color:#f92672">,</span> 5<span style="color:#f92672">}};</span>
        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>minCost<span style="color:#f92672">(</span>n<span style="color:#f92672">,</span> edges<span style="color:#f92672">,</span> newEdges<span style="color:#f92672">));</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">minCost</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> n<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[][]</span> edges<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[][]</span> newEdges<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        UF uf <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> UF<span style="color:#f92672">(</span>n <span style="color:#f92672">+</span> 1<span style="color:#f92672">);</span> <span style="color:#75715e">// + 1 because nodes are 1-based
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> edge <span style="color:#f92672">:</span> edges<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            uf<span style="color:#f92672">.</span><span style="color:#a6e22e">union</span><span style="color:#f92672">(</span>edge<span style="color:#f92672">[</span>0<span style="color:#f92672">],</span> edge<span style="color:#f92672">[</span>1<span style="color:#f92672">]);</span>
        <span style="color:#f92672">}</span>

        Queue<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">[]&gt;</span> pq <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PriorityQueue<span style="color:#f92672">&lt;&gt;(</span>newEdges<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">,</span> <span style="color:#f92672">(</span>e1<span style="color:#f92672">,</span> e2<span style="color:#f92672">)</span> <span style="color:#f92672">-&gt;</span> Integer<span style="color:#f92672">.</span><span style="color:#a6e22e">compare</span><span style="color:#f92672">(</span>e1<span style="color:#f92672">[</span>2<span style="color:#f92672">],</span> e2<span style="color:#f92672">[</span>2<span style="color:#f92672">]));</span>
        pq<span style="color:#f92672">.</span><span style="color:#a6e22e">addAll</span><span style="color:#f92672">(</span>Arrays<span style="color:#f92672">.</span><span style="color:#a6e22e">asList</span><span style="color:#f92672">(</span>newEdges<span style="color:#f92672">));</span>

        <span style="color:#66d9ef">int</span> totalCost <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span>
        <span style="color:#75715e">// 2 because nodes are 1-based and we have 1 unused component at index 0
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">while</span> <span style="color:#f92672">(!</span>pq<span style="color:#f92672">.</span><span style="color:#a6e22e">isEmpty</span><span style="color:#f92672">()</span> <span style="color:#f92672">&amp;&amp;</span> uf<span style="color:#f92672">.</span><span style="color:#a6e22e">count</span> <span style="color:#f92672">!=</span> 2<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> edge <span style="color:#f92672">=</span> pq<span style="color:#f92672">.</span><span style="color:#a6e22e">poll</span><span style="color:#f92672">();</span>
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(!</span>uf<span style="color:#f92672">.</span><span style="color:#a6e22e">connected</span><span style="color:#f92672">(</span>edge<span style="color:#f92672">[</span>0<span style="color:#f92672">],</span> edge<span style="color:#f92672">[</span>1<span style="color:#f92672">]))</span> <span style="color:#f92672">{</span>
                uf<span style="color:#f92672">.</span><span style="color:#a6e22e">union</span><span style="color:#f92672">(</span>edge<span style="color:#f92672">[</span>0<span style="color:#f92672">],</span> edge<span style="color:#f92672">[</span>1<span style="color:#f92672">]);</span>
                totalCost <span style="color:#f92672">+=</span> edge<span style="color:#f92672">[</span>2<span style="color:#f92672">];</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
        <span style="color:#66d9ef">return</span> totalCost<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UF</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> parent<span style="color:#f92672">;</span>  <span style="color:#75715e">// parent[i] = parent of i
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> rank<span style="color:#f92672">;</span>   <span style="color:#75715e">// rank[i] = rank of subtree rooted at i (never more than 31)
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> count<span style="color:#f92672">;</span>      <span style="color:#75715e">// number of connected components
</span><span style="color:#75715e"></span>
    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">UF</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> n<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>n <span style="color:#f92672">&lt;</span> 0<span style="color:#f92672">)</span> <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> IllegalArgumentException<span style="color:#f92672">();</span>
        parent <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[</span>n<span style="color:#f92672">];</span>
        rank <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>n<span style="color:#f92672">];</span>
        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> n<span style="color:#f92672">;</span> i<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
            parent<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> i<span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
        count <span style="color:#f92672">=</span> n<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">find</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> p<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>p <span style="color:#f92672">!=</span> parent<span style="color:#f92672">[</span>p<span style="color:#f92672">])</span> <span style="color:#f92672">{</span>
            parent<span style="color:#f92672">[</span>p<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> parent<span style="color:#f92672">[</span>parent<span style="color:#f92672">[</span>p<span style="color:#f92672">]];</span>
            p <span style="color:#f92672">=</span> parent<span style="color:#f92672">[</span>p<span style="color:#f92672">];</span>
        <span style="color:#f92672">}</span>
        <span style="color:#66d9ef">return</span> p<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">union</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> p<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> q<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">int</span> pr <span style="color:#f92672">=</span> find<span style="color:#f92672">(</span>p<span style="color:#f92672">);</span>
        <span style="color:#66d9ef">int</span> qr <span style="color:#f92672">=</span> find<span style="color:#f92672">(</span>q<span style="color:#f92672">);</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>pr <span style="color:#f92672">==</span> qr<span style="color:#f92672">)</span> <span style="color:#66d9ef">return</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>rank<span style="color:#f92672">[</span>pr<span style="color:#f92672">]</span> <span style="color:#f92672">&lt;</span> rank<span style="color:#f92672">[</span>qr<span style="color:#f92672">])</span> <span style="color:#f92672">{</span>
            parent<span style="color:#f92672">[</span>pr<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> qr<span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
            parent<span style="color:#f92672">[</span>qr<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> pr<span style="color:#f92672">;</span>
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>rank<span style="color:#f92672">[</span>pr<span style="color:#f92672">]</span> <span style="color:#f92672">==</span> rank<span style="color:#f92672">[</span>qr<span style="color:#f92672">])</span> rank<span style="color:#f92672">[</span>pr<span style="color:#f92672">]++;</span>
        <span style="color:#f92672">}</span>
        count<span style="color:#f92672">--;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">connected</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> p<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> q<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> find<span style="color:#f92672">(</span>p<span style="color:#f92672">)</span> <span style="color:#f92672">==</span> find<span style="color:#f92672">(</span>q<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div>
  </div>

  <div id="disqus_thread"></div>
<script>
  

  

  (function() { 
    var d = document, s = d.createElement('script');
    s.src = 'https://hashnopolis.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


        </section>
        

      </div>
      

  </main>

  


<script src="/js/bundle.js"></script>


<script src="/js/vendor/modernizr.custom.32229-2.8-respondjs-1-4-2.js"></script>
<script src="/js/vendor/jquery-1.11.2.min.js"></script>
<script src="/js/vendor/jquery.jpanelmenu.min.js"></script>
<script src="/js/vendor/highlight.min.js"></script>
<script src="/js/vendor/fastclick.min.js"></script>
<script src="/js/main.js"></script>


<script id="dsq-count-scr" src="//hashnopolis.disqus.com/count.js" async></script>

</body>

</html>